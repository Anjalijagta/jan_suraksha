name: Jan Suraksha Bot

on:
  pull_request:
    types: [opened, synchronize]

permissions:
  contents: read
  pull-requests: write
  issues: write

jobs:
  review-and-welcome:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

     
      - name: Send Welcome Comment
        continue-on-error: true 
        uses: actions/github-script@v6
        with:
          script: |
            const user = context.payload.pull_request.user.login;
            const message = `
            ğŸ‘‹ **Hi @${user}!** Thanks for contributing to **Jan Suraksha**! ğŸ›¡ï¸
            I am the repository bot. I have started checking your code for errors.
            
            Please wait for the checks to complete below. ğŸ‘‡
            `;
            
            try {
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.issue.number,
                body: message
              });
            } catch (err) {
              console.log("Could not comment, but continuing checks...");
            }

    
      - name: Check PHP Syntax
        run: |
          echo "ğŸ” Scanning PHP files for syntax errors..."
          # This command finds all .php files and checks them for errors
          # If no PHP files are found, it continues safely
          find . -name "*.php" -print0 | xargs -0 -r -n1 php -l
